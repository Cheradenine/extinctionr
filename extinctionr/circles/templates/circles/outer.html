{% extends "base.html" %}
{% block title %}:: Circles{% endblock %}
{% block inline_css %}
{{block.super}}
.circle {
	font-size: .8em;
}

{% endblock %}
{% block content %}
{% load info %}
{% if not user.is_authenticated %}
<h4 class="pt-3 text-right"><a href="{% url 'login' %}">login</a></h4>
{% endif %}
{% for circle in object_list %}
<div class="circle row pt-5" style="background-color: {{circle.bgcolor}}">
	<div class="col col-lg-2 pt-4 p-3">
		<h3 class="text-center"><a href="{% url 'circles:detail' pk=circle.id %}">{{circle.name}}</a></h3>
		{% if can_see_members %}<h5 class="text-center">{{circle.get_all_members|length}} members</h5>{% endif %}
		{{circle.purpose|markdownify}}
	</div>
    <div class="col-10 container d-none d-sm-block">
		{% for sub1 in circle.circle_set.all %}
		<div class="circle row border" style="background-color: {{sub1.bgcolor}}">
           <div class="col-5 pt-4 p-2 border">
				<h3 class="text-center"><a href="{{sub1.get_absolute_url}}">{{sub1.name}}</a></h3>
				{% if can_see_members %}<h5 class="text-center pb-4">{{sub1.get_all_members|length}} members</h5>{% endif %}
				{{sub1.purpose|markdownify}}
			</div>
			<div class="col border container">
				{% for sub2 in sub1.get_children %}
				<div class="circle row" style="background-color: {{sub2.bgcolor}}">
                   <div class="col pt-4 p-2 border">
						<h3 class="text-center"><a href="{{sub2.get_absolute_url}}">{{sub2.name}}</a></h3>
						{% if can_see_members %}
						<h5 class="text-center">{{sub2.get_members.count}} members{% if not sub2.get_leads %} &mdash; <span class="text-danger">no leads</span>{% endif %}</h5>
						<ul class="list-unstyled lead px-4 text-center">
						{% for contact in sub2.get_leads %}
						<li><a href="{% url 'circles:person' contact_id=contact.id %}">{{contact}}</a></li>
						{% endfor %}
						</ul>
						{% endif %}
						{{sub2.purpose|markdownify}}
					</div>
				</div>
				{% endfor %}
			</div>
		</div>
		{% endfor %}
	</div>
</div>
{% endfor %}


{% endblock %}
