{% extends "base.html" %}
{% load info %}
{% load static %}
{% load tz %}
{% load wagtailcore_tags wagtailimages_tags %}
{% block body_class %}template-newsindexpage{% endblock %}

{% block extrahead %}
<link rel="stylesheet" href="{% static 'css/xr-blog.css' %}">
{% endblock %}
{% block title %}:: Stories{% endblock %}
{% block og_tags %}
  <meta property="og:description" content="News and Stories from Extinction Rebellion Massachusetts" />
{% endblock %}
{% block inline_css %}

.grid-sizer,
.grid-item {
	float: left;
	width: 30%;
}

.grid:after {
	content: '';
	display: block;
	clear: both;
}

ul.page-nav li {
	color: #808080;
	display: inline;
	padding: .1em;
    font-family: FucXed, sans-serif;
}
ul.page-nav li.cur-page {
	color: black;
}
ul.page-nav li a {
	color: black;
	font-family: FucXed, sans-serif;
	text-decoration: underline;
}
ul.page-nav li a:active 
ul.page-nav li a:hover {
	color: rgb(20, 170, 55);
}

.aspect-ratio-16-9 {
	width:100%;
	padding-top:56.25%;
	position: relative;
	overflow:hidden;
}

.aspect-ratio-16-9 div {
	position: absolute;
	top: 0;
	left: 0;
	bottom: 0;
	right: 0;
	display: flex;
	justify-content: center;
	align-items: center;
 }

 .nav-item .nav-link {
	font-family: FucXed, sans-serif;
	color: black;
	font-size: 1.2rem;
}

 .nav-item a.active,
 .nav-item a:hover {
	color: #22a83e !important;
 }

{{block.super}}

{% endblock %}
{% block content %}

<div class="row bg-white">
<div class="col-8 w-100 offset-2">
<!-- secondary nav for media -->
<!-- TODO these will be auto generated from page structure -->
<ul class="nav nav-fill">
  <li class="nav-item">
    <a class="nav-link active" href="/news">News</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#">Video</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#">People</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#">Press</a>
  </li>
</ul>
</div>
</div>

<div class="row m-5">
    {{page.intro|richtext}}
</div>

<div class="row">
	<!-- story grid -->
	<div class="col-10 offset-1">
		<div class="grid">
			<div class="grid-sizer"></div>
			{% for story in stories %}
				{% with story=story.specific %}
				<div class="grid-item my-2">
					<div class="bg-white">
						{% with story.hero_image as hero_image %}
							{% if hero_image %}
								{% image hero_image fill-1024x576 %}
							{% elif story.media_thumbnail_url %}
								<div class="aspect-ratio-16-9">
								<div>
									<img src="{{story.media_thumbnail_url}}" width="100%">
								</div>
								</div>
							{% endif %}
						{% endwith %}
						<div class="p-2">
							<div><a href="{% pageurl story %}" class="blog-link blog-list-title"><strong>{{story.title}}</strong></a></div>
							<div class="blog-byline">By {{story.author}} | {{story.date}}</div>
							<p class="mt-2">{{story.lede}}</p>
							{% for tag in story.tags.all %}
							<span class="blog-tag mr-2 my-1"><a href="{% pageurl page %}?tag={{tag}}">{{tag}}</a></span>
							{% endfor %}
							<div class="mt-4 text-fucxed">
								<span class="blog-btn p-1"><a href="{% pageurl story%}">Read more</a></span>
							</div>
						</div>
					</div>
				</div>
				{% endwith %}
			{% endfor %}
		</div>
	</div>
</div>
{% endblock %}
{% block extra_js %}
<script src="{% static 'js/masonry.pkgd.min.js' %}"></script>
<script src="{% static 'js/imagesloaded.pkgd.min.js' %}"></script>
<script>
var el = document.querySelector('.grid');
var imgLoad = imagesLoaded(el);
imgLoad.on('always', function(x){
	var msnry = new Masonry(el, {
		// options
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		percentPosition: true,
		horizontalOrder: true,
		gutter: 16,
	});
});
</script>

{% endblock %}